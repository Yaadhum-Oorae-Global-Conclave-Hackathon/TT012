require(['gitbook','jquery'],function(gitbook,$){function AlgoliaSearchEngine(config){this.client=algoliasearch(config.algolia.applicationID,config.algolia.publicKey);this.index=this.client.initIndex(config.algolia.index);this.name='AlgoliaSearchEngine';}
AlgoliaSearchEngine.prototype.init=function(){return $.Deferred().resolve().promise();};AlgoliaSearchEngine.prototype.search=function(q,offset,length){var d=$.Deferred();this.index.search(q,{hitsPerPage:length}).then(function(res){var results=res.hits.map(function(hit){return{title:hit.title,body:hit['_highlightResult'].body.value,url:hit.url};});d.resolve({query:res.query,count:res.nbHits,results:results});}).catch(function(err){d.reject(err);});return d.promise();};gitbook.events.bind('start',function(e,config){gitbook.search.setEngine(AlgoliaSearchEngine,config);});});